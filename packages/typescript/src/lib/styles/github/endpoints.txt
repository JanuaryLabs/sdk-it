type DispatchReturn<E extends keyof typeof schemas> = Awaited<
  ReturnType<(typeof schemas)[E]['dispatch']>
>;

export type InferData<E extends keyof typeof schemas> =
  DispatchReturn<E> extends APIResponse<infer D> ? D : DispatchReturn<E>;

type EndpointOutput<K extends keyof typeof schemas> = Extract<
  Unionize<(typeof schemas)[K]['output']>,
  SuccessfulResponse
>;

type EndpointError<K extends keyof typeof schemas> = Extract<
  Unionize<(typeof schemas)[K]['output']>,
  ProblematicResponse
>;

export type Endpoints = {
  [E in keyof typeof schemas]: {
    input: z.input<(typeof schemas)[E]['schema']>;
    output: InferData<E>;
    error: EndpointError<E> | ParseError<(typeof schemas)[E]['schema']>;
  };
};
